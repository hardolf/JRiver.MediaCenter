; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES:
; http://www.jrsoftware.org/isdl.php

[Setup]
;ArchitecturesInstallIn64BitMode=x64
AppName=Lyrics Finder Plugin for JRiver MediaCenter
AppPublisher=Hardolf
AppPublisherURL=www.hardolf.dk
AppSupportURL=www.hardolf.dk
AppUpdatesURL=www.hardolf.dk
AppVerName=Plugin Version 1.0.0.0
Compression=lzma
DefaultDirName={pf}\J River\Media Center 24\Plugins\LyricsFinder
DefaultGroupName=MediaCenter LyricsFinder
DirExistsWarning=no
DisableDirPage=no
DisableProgramGroupPage=yes
OutputBaseFilename=SetupPlugin
SolidCompression=yes

[Languages]
Name: "english"; MessagesFile: "compiler:Default.isl"

[Files]
Source: "Build\Plugin\*";                           DestDir: "{app}";                 Flags: ignoreversion recursesubdirs createallsubdirs
Source: "Build\LyricServices\*";                    DestDir: "{app}";                 Flags: ignoreversion recursesubdirs createallsubdirs
Source: "Build\LyricServices\MessageInspection.*";  DestDir: "{app}\..\..";           Flags: ignoreversion recursesubdirs createallsubdirs
; NOTE: Don't use "Flags: ignoreversion" on any shared system files

[Icons]
Name: "{group}\{cm:UninstallProgram, Plugin}"; Filename: "{uninstallexe}"

[Registry]
Root: HKLM; Subkey: "SOFTWARE\J. River\Media Center 24\Plugins\Interface\LyricsFinder";                                                                                            Flags: uninsdeletekey
Root: HKLM; Subkey: "SOFTWARE\J. River\Media Center 24\Plugins\Interface\LyricsFinder"; ValueType: dword;  ValueName: "IVersion";   ValueData: "00000001";                         Flags: uninsdeletekey
Root: HKLM; Subkey: "SOFTWARE\J. River\Media Center 24\Plugins\Interface\LyricsFinder"; ValueType: string; ValueName: "Company";    ValueData: "Hardolf";                          Flags: uninsdeletekey
Root: HKLM; Subkey: "SOFTWARE\J. River\Media Center 24\Plugins\Interface\LyricsFinder"; ValueType: string; ValueName: "Version";    ValueData: "1.0.0.0";                          Flags: uninsdeletekey
Root: HKLM; Subkey: "SOFTWARE\J. River\Media Center 24\Plugins\Interface\LyricsFinder"; ValueType: string; ValueName: "URL";        ValueData: "www.hardolf.dk";                   Flags: uninsdeletekey
Root: HKLM; Subkey: "SOFTWARE\J. River\Media Center 24\Plugins\Interface\LyricsFinder"; ValueType: string; ValueName: "Copyright";  ValueData: "Copyright (c) Hardolf 2019";       Flags: uninsdeletekey
Root: HKLM; Subkey: "SOFTWARE\J. River\Media Center 24\Plugins\Interface\LyricsFinder"; ValueType: dword;  ValueName: "PluginMode"; ValueData: "00000001";                         Flags: uninsdeletekey
Root: HKLM; Subkey: "SOFTWARE\J. River\Media Center 24\Plugins\Interface\LyricsFinder"; ValueType: string; ValueName: "ProdID";     ValueData: "MediaCenter.LyricsFinder.Plugin";  Flags: uninsdeletekey
;Root: HKLM; Subkey: "SOFTWARE\J. River\Media Center 24\Plugins\Interface\LyricsFinder"; ValueType: string; ValueName: "Path";       ValueData: "[Install Path]Plugins\LyricsFinder\LyricsFinderPlugin.dll";  Flags: uninsdeletekey

[Run]
Filename: "{win}\Microsoft.NET\Framework\v4.0.30319\RegAsm.exe"; Parameters: "/codebase   LyricsFinderCore.dll";     WorkingDir: "{app}\"; StatusMsg: "Registering Plugin Core";   Flags:runascurrentuser
Filename: "{win}\Microsoft.NET\Framework\v4.0.30319\RegAsm.exe"; Parameters: "/codebase   LyricsFinderPlugin.dll";   WorkingDir: "{app}\"; StatusMsg: "Registering Plugin";        Flags:runascurrentuser

[UninstallRun]
Filename: "{win}\Microsoft.NET\Framework\v4.0.30319\RegAsm.exe"; Parameters: "/unregister LyricsFinderCore.dll";     WorkingDir: "{app}\"; StatusMsg: "UnRegistering Plugin Core"; Flags:runascurrentuser
Filename: "{win}\Microsoft.NET\Framework\v4.0.30319\RegAsm.exe"; Parameters: "/unregister LyricsFinderPlugin.dll";   WorkingDir: "{app}\"; StatusMsg: "UnRegistering Plugin";      Flags:runascurrentuser
